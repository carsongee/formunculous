{% extends "formunculous/base.html" %}
{% load i18n %}
{% block css %}
<link href="{{ MEDIA_URL }}formunculous/css/formunculous.css" rel="stylesheet" type="text/css" />
<link href="{{ MEDIA_URL }}formunculous/css/smoothness/jquery-ui-1.7.2.custom.css" rel="stylesheet" type="text/css">
{% endblock %}

{% block js %}
<script type="text/javascript" src="{{ MEDIA_URL }}formunculous/js/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}formunculous/js/jquery-ui-1.7.2.custom.min.js"></script>
<script type="text/javascript">
var delete_url = "{% url reviewer-delete ad.slug %}";
var app_id = 0

$(document).ready(function()
{
$('#del_dialog').dialog({
       autoOpen: false,
       modal: true,
       width: 400,
       buttons: {
             "OK": function() {
                 $.ajax( { url: delete_url,
                           type: "POST",
                           datatype: "html",
                           data: { id: app_id },
                           success: function() {
                                   $('#del_dialog').dialog('close');
                                   $('#ajax_results').html("<p>Application Successfully Deleted</p>");
                                   $('#ajax_results').effect('highlight',{},1500);
                                   $('#app_' + app_id).parent('tr').fadeOut(1000, function() {$(this).remove();});
                           },
                           error: function() {
                                   $('#del_dialog').dialog('close');
                                   $('#ajax_results').html("<p>Unable to delete the application</p>");
                                   $('#ajax_results').effect('highlight',{},1500);
                                   }
                        });

              },
             "Cancel": function() {
                 $(this).dialog("close");
             }
       },
       show: 'drop',
       bgiframe: true
});

});
function deleteApp(id) {
	app_id = id;
	$('#del_dialog').dialog('open');
}

</script>
{% endblock %}

{% block title %}
{% trans "Completed" %} {{ ad.name }} {% trans "Submissions" %}
{% endblock %}

{% block content_title %}
{% trans "Completed" %} {{ ad.name }} {% trans "Submissions" %}
{% endblock %}

{% block content %}

<div id="del_dialog" title="{% trans "Confirm Application Delete" %}">
  <p>
	Deleting the selected application cannot be undone.  Are you sure
	you want to delete this application?
  </p>
</div>
<div id="ajax_results">
</div>

<table class="formunculous_table formunculous_review_table">
<thead>
<tr>
  {% for header in headers %}
  <th>
	<a href="{{ header.url }}">{{ header.name }}</a>
  </th>
  {% if forloop.last %}
    <th>
	  {% trans "Actions" %}
	</th>
  {% endif %}
  {% endfor %}
</tr>
</thead>
<tbody>
  {% for row in data %}
  <tr class="{% cycle 'odd' 'even' %}">
	{% for col in row %}

	{% if not forloop.last %}
	<td>
	  {% if col.url %}
	  <a href="{{ col.url }}">
	  {% endif %}
	  {{ col.value }}
	  {% if col.url %}
	  </a>
	  {% endif %}
	</td>
	{% else %}
	<td><a href="{{ col.url }}">{{ col.value|date:"D d M Y" }} {{ col.value|time:"g:i A" }}</a></td>
	<td id="app_{{ col.id }}"><a href="#" class="formunculous-deletelink" style="padding-left: 20px;" onclick="deleteApp({{ col.id }});">{% trans "Delete" %}</a></td>
	{% endif %}

	{% endfor %}
  </tr>
  {% endfor %}
</tbody>
</table>

{% endblock %}
